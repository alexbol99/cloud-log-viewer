(this["webpackJsonpdfms-running-chart"]=this["webpackJsonpdfms-running-chart"]||[]).push([[0],{130:function(e,t,n){},131:function(e,t,n){"use strict";n.r(t);var a=n(9),i=n.n(a),r=n(73),o=n.n(r),c=(n(93),n(8)),l=n.n(c),u=n(12),m=n(10),s=n(74),d=n.n(s),g=n(59),p=n.n(g),L=n(25),f=n.n(L);var h=function(e){var t=Object(a.useRef)();Object(a.useEffect)((function(){e.selected&&o()}));var n=e.selected?f.a.RunningLogListItemClicked:f.a.RunningLogListItem,r="https://s3.console.aws.amazon.com/s3/object/acp-cloud-logs/"+e.data.key,o=function(){var e=t.current.parentElement.parentElement.getBoundingClientRect(),n=t.current.getBoundingClientRect();n.bottom>e.bottom&&t.current.scrollIntoView(!1),n.top<e.top&&t.current.scrollIntoView(!0)};return i.a.createElement("tr",{className:n,onClick:e.itemClicked,ref:t},i.a.createElement("td",null,e.data.runningDate),i.a.createElement("td",null,e.data.jobName),i.a.createElement("td",null,e.data.step),i.a.createElement("td",null,e.data.checklist),i.a.createElement("td",{className:f.a.RunningLogListItemNumeric},e.data.actionsNum),i.a.createElement("td",{className:f.a.RunningLogListItemNumeric},e.data.layersNum),i.a.createElement("td",{className:f.a.RunningLogListItemNumeric},e.data.batchJobsNum),i.a.createElement("td",null,e.data.runningTime||"Failed"),i.a.createElement("td",null,i.a.createElement("a",{href:r,target:"_blank",rel:"noopener noreferrer"},e.data.key)))};var b=function(e){var t;return Object(a.useEffect)((function(){var t=function(t){switch(t.code){case"ArrowDown":t.stopPropagation(),t.preventDefault(),e.logItemClicked(Math.min(e.selectedIndex+1,e.logsListData.length-1));break;case"ArrowUp":t.stopPropagation(),t.preventDefault(),e.logItemClicked(Math.max(e.selectedIndex-1,0))}};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}})),i.a.createElement("div",{className:p.a.RunningLogsList},i.a.createElement("header",null,i.a.createElement("span",null,"Amazon s3 >"),i.a.createElement("span",null,i.a.createElement("a",{href:"https://s3.console.aws.amazon.com/s3/buckets/acp-cloud-logs/?region=eu-central-1&tab=overview#",target:"_blank",rel:"noopener noreferrer"},"acp-cloud-logs"))),i.a.createElement("table",{className:p.a.RunningLogsListTable},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Running date"),i.a.createElement("th",null,"Job Name"),i.a.createElement("th",null,"Step"),i.a.createElement("th",null,"Checklist"),i.a.createElement("th",null,"# Actions"),i.a.createElement("th",null,"# Layers"),i.a.createElement("th",null,"# ACPs"),i.a.createElement("th",null,"Running Time"),i.a.createElement("th",null,"S3 bucket key (filename)"))),i.a.createElement("tbody",null,null===(t=e.logsListData)||void 0===t?void 0:t.map((function(t,n){return i.a.createElement(h,{key:n,data:t,selected:e.selectedIndex===n,itemClicked:function(){return e.logItemClicked(n)}})})))))},v=n(137),E=n(75),N=n.n(E);var I=function(e){var t,n={title:null===(t=e.runData)||void 0===t?void 0:t.jobName,data:{values:e.data},mark:{type:"bar",tooltip:[]},encoding:{x:{type:"temporal",field:"StartDate",timeUnit:"hoursminutesseconds"},x2:{type:"temporal",field:"EndDate",timeUnit:"hoursminutesseconds"},y:{type:"nominal",field:"Index",sort:null},color:{field:"Object"}},width:800,autosize:"fit"};return i.a.createElement("div",{className:N.a.VegaLiteChart},e.data&&e.runData.runningTime?i.a.createElement(v.a,{spec:n,data:e.data}):"No data")},R=n(2);function w(e){var t=null===e||void 0===e?void 0:e.batch[e.batch.length-1].ActNum,n=new Set(null===e||void 0===e?void 0:e.batch.map((function(e){return e.LayerName}))).size;return{runningDate:null===e||void 0===e?void 0:e.runningDate,jobName:null===e||void 0===e?void 0:e.jobName,step:null===e||void 0===e?void 0:e.batch[0].StepName,checklist:null===e||void 0===e?void 0:e.batch[0].ChecklistName,actionsNum:t,layersNum:n,runningTime:null===e||void 0===e?void 0:e.runningTime,batchJobsNum:null===e||void 0===e?void 0:e.batch.length,key:null===e||void 0===e?void 0:e.key}}function D(e,t){var n=e.split(":").map((function(e){return Number(e)})),a=3600*n[0]+60*n[1]+n[2],i=t.split(":").map((function(e){return Number(e)}));return 3600*i[0]+60*i[1]+i[2]-a}var k=function(e){var t=Object(a.useState)([]),n=Object(m.a)(t,2),r=n[0],o=n[1],c=Object(a.useState)([]),s=Object(m.a)(c,2),g=s[0],p=s[1],L=Object(a.useState)(null),f=Object(m.a)(L,2),h=f[0],v=f[1],E=Object(a.useState)(null),N=Object(m.a)(E,2),k=N[0],T=N[1],_=Object(a.useState)(0),S=Object(m.a)(_,2),C=S[0],j=S[1];function x(){return y.apply(this,arguments)}function y(){return(y=Object(u.a)(l.a.mark((function e(){var t,n,a,i,r,o,c,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="https://bah2tkltg6.execute-api.eu-central-1.amazonaws.com/test/list",e.next=3,fetch(t);case 3:return n=e.sent,e.next=6,n.json();case 6:return a=e.sent,i=JSON.parse(a.body).keys,r=i.map((function(e){return fetch("".concat(t,"/").concat(e))})),e.next=11,Promise.all(r);case 11:return o=e.sent,c=o.map((function(e){return e.json()})),e.next=15,Promise.all(c);case 15:return(u=e.sent).forEach((function(e,t){return e.key=i[t]})),u.sort((function(e,t){return new Date(t.runningDate)-new Date(e.runningDate)})),e.abrupt("return",u);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){var e=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x();case 2:(t=e.sent).length>0&&o(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();0===r.length&&e()})),Object(a.useEffect)((function(){if(r.length>0){var e=r.map((function(e){return w(e)}));p(e)}}),[r]),Object(a.useEffect)((function(){if(r.length>0){var e=r[C],t=e.runningTime?function(e){var t=e.batch.map((function(t){var n=e.acpTime.find((function(e){return e.Stage===t.Stage&&e.Index===t.StageIndex}));return{Object:"Acp",ActNum:t.ActNum,Name:t.AnalysisName,Layer:t.LayerName,Stage:t.Stage,Index:t.Stage+"_"+t.StageIndex,StartTime:n?n.StartTime:"",CompleteTime:n?n.CompleteTime:"",Time:D(n.StartTime,n.CompleteTime),StartDate:new Date("01/01/1970 ".concat(n.StartTime)),EndDate:new Date("01/01/1970 ".concat(n.CompleteTime))}})),n={Object:"Splitter",Name:"Splitter",Index:0,StartDate:new Date("01/01/1970 ".concat(e.splitterTime.StartTime)),EndDate:new Date("01/01/1970 ".concat(e.splitterTime.CompleteTime))},a={Object:"Merger",Name:"Merger",Index:t.length+1,StartDate:new Date("01/01/1970 ".concat(e.mergerTime.StartTime)),EndDate:new Date("01/01/1970 ".concat(e.mergerTime.CompleteTime))},i={Object:"Upload",Name:"Upload",Index:-1,StartDate:new Date("01/01/1970 ".concat(e.uploadTime.StartTime)),EndDate:new Date("01/01/1970 ".concat(e.uploadTime.CompleteTime))},r={Object:"Download",Name:"Download",Index:t.length+2,StartDate:new Date("01/01/1970 ".concat(e.downloadTime.StartTime)),EndDate:new Date("01/01/1970 ".concat(e.downloadTime.CompleteTime))};return t=[i,n].concat(Object(R.a)(t),[a,r])}(e):null,n=w(e);v(t),T(n)}}),[r,C]),i.a.createElement("main",{className:d.a.MainComponent},i.a.createElement(b,{logsListData:g,selectedIndex:C,logItemClicked:function(e){j(e)}}),i.a.createElement(I,{data:h,runData:k}))};n(130);var T=function(){return i.a.createElement("div",{className:"App"},i.a.createElement("h1",null,"Cloud Running Logs"),i.a.createElement("hr",null),i.a.createElement(k,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},25:function(e,t,n){e.exports={RunningLogListItem:"RunningLogListItem_RunningLogListItem__1S2n8",RunningLogListItemClicked:"RunningLogListItem_RunningLogListItemClicked__14z5x",RunningLogListItemNumeric:"RunningLogListItem_RunningLogListItemNumeric__24czR",RunningLogListItemJobName:"RunningLogListItem_RunningLogListItemJobName__Y8UPs",RunningLogListItemNumActions:"RunningLogListItem_RunningLogListItemNumActions__1Ci-9",RunningLogListItemNumLayers:"RunningLogListItem_RunningLogListItemNumLayers__3gAIe",RunningLogListItemRunningTime:"RunningLogListItem_RunningLogListItemRunningTime__20Nah"}},59:function(e,t,n){e.exports={RunningLogsList:"RunningLogsList_RunningLogsList__3FvQO",RunningLogsListTable:"RunningLogsList_RunningLogsListTable__lSMj_"}},74:function(e,t,n){e.exports={MainComponent:"MainComponent_MainComponent__v6Cpx"}},75:function(e,t,n){e.exports={VegaLiteChart:"VegaLiteChart_VegaLiteChart__2LGfz"}},88:function(e,t,n){e.exports=n(131)},93:function(e,t,n){}},[[88,1,2]]]);
//# sourceMappingURL=main.b2c86726.chunk.js.map